
# `modeling.earthquake.damage` <img src='https://i.imgur.com/m7lDBGD.png' align="right" height="45"/>

<!-- badges: start -->

[![Travis build
status](https://travis-ci.org/data-science-competitions/modeling.earthquake.damage.svg?branch=master)](https://travis-ci.org/data-science-competitions/modeling.earthquake.damage)
[![Code coverage
status](https://codecov.io/gh/data-science-competitions/modeling.earthquake.damage/branch/master/graph/badge.svg)](https://codecov.io/github/data-science-competitions/modeling.earthquake.damage/?branch=master)
[![Launch Rstudio
Binder](http://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/data-science-competitions/modeling.earthquake.damage/master?urlpath=rstudio)
<!-- badges: end -->

<!-- Package Title -->

Richterâ€™s Predictor: Modeling Earthquake
Damage

-----

<img src="https://i.imgur.com/2sfOQSa.png" width="100%" style="display: block; margin: auto;" />

<!-- Package Description -->

## Description

Predict the level of damage to buildings that were hit by the Gorkha
earthquake.

## Installation

`modeling.earthquake.damage` accommodates two stages in the project
life-cycle: Development and Production.

### Working in Pseudo-Package Mode (Advised During Development Stage)

1.  Download the project to local computer
2.  Launch the project via `modeling.earthquake.damage.Rproj`
3.  Optional: Install all package
dependencies

<!-- end list -->

``` r
remotes::install_local(dependencies = TRUE, force = TRUE, upgrade = "always")
devtools::uninstall()
```

4.  Load the complete project as a package via `devtools::load_all()` or
    Ctrl+Shift+L

### Working in Package Mode (Advised During Production Stage)

    install.packages("devtools")
    devtools::install_github("data-science-competitions/modeling.earthquake.damage")

## Data Pipeline

The template includes a database abstraction layer (DAL) that separates
data sources and analytic applications. The DAL has three stages with
the following functionality:

1.  `Ingest`

<!-- end list -->

  - Pull data from external sources; and
  - Matching schema, organizing, indexing, encoding and compressing the
    data.

<!-- end list -->

2.  `Prepare`

<!-- end list -->

  - Type conversion of variables if necessary; and
  - Data cleansing;

<!-- end list -->

3.  `Store`

<!-- end list -->

  - Create a data model if relational tables exist;
  - Introduce new features and ready-for-modelling tables; and
  - Make the data available for query.

The template provides skeletons for `Ingest`, `Prepare` and `Store`
interfaces. In addition, the template includes a toy example which
demonstrates the data flow between all three interfaces.

<!--
### Ingest Layer Interface and its Implementation


```r
ingest_abstract <- Ingest$new(path = tempdir())
class(ingest_abstract)

ingest_concrete <- IngestDAO$new(path = tempdir())
class(ingest_concrete)
```

### Prepare Layer Interface and its Implementation


```r
prepare_abstract <- Prepare$new()
class(prepare_abstract)

prepare_concrete <- PrepareDAO$new()
class(prepare_concrete)
```

### DataStore Object


```r
ds <- DataStore$new()
class(ds)
```
-->

## Datasets

### Accessing the Project Data

``` r
ds <- DataStore$new()
names(ds$data_model)
```

    ## [1] "historical_data"   "new_data"          "submission_format"

### Data Overview

<img src="README_files/figure-gfm/project-data-overview-1.png" width="100%" style="display: block; margin: auto;" />

<!--
### Data Model


-->

### Data Glimpse

    ## ---
    ## historical_data

    ## Observations: 260,601
    ## Variables: 40
    ## $ building_id                            <chr> "802906", "28830", "94947", "590882", "201944", ...
    ## $ geo_level_1_id                         <int> 6, 8, 21, 22, 11, 8, 9, 20, 0, 26, 17, 17, 12, 1...
    ## $ geo_level_2_id                         <int> 487, 900, 363, 418, 131, 558, 475, 323, 757, 886...
    ## $ geo_level_3_id                         <int> 12198, 2812, 8973, 10694, 1488, 6089, 12066, 122...
    ## $ count_floors_pre_eq                    <int> 2, 2, 2, 2, 3, 2, 2, 2, 2, 1, 2, 1, 2, 3, 2, 2, ...
    ## $ age                                    <int> 30, 10, 10, 10, 30, 10, 25, 0, 15, 0, 20, 10, 15...
    ## $ area_percentage                        <int> 6, 8, 5, 6, 8, 9, 3, 8, 8, 13, 9, 8, 6, 7, 7, 4,...
    ## $ height_percentage                      <int> 5, 7, 5, 5, 9, 5, 4, 6, 6, 4, 6, 4, 5, 7, 6, 4, ...
    ## $ land_surface_condition                 <fct> t, o, t, t, t, t, n, t, t, t, t, t, t, t, t, n, ...
    ## $ foundation_type                        <fct> r, r, r, r, r, r, r, w, r, i, r, u, r, r, r, r, ...
    ## $ roof_type                              <fct> n, n, n, n, n, n, n, q, q, n, q, n, n, q, n, n, ...
    ## $ ground_floor_type                      <fct> f, x, f, f, f, f, x, v, f, v, f, v, x, f, f, f, ...
    ## $ other_floor_type                       <fct> q, q, x, x, x, q, q, x, q, j, q, j, x, q, x, q, ...
    ## $ position                               <fct> t, s, t, s, s, s, s, s, s, s, t, t, s, s, s, s, ...
    ## $ plan_configuration                     <fct> d, d, d, d, d, d, d, u, d, d, d, d, d, d, d, d, ...
    ## $ has_superstructure_adobe_mud           <lgl> TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, F...
    ## $ has_superstructure_mud_mortar_stone    <lgl> TRUE, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, FALSE...
    ## $ has_superstructure_stone_flag          <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_cement_mortar_stone <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_mud_mortar_brick    <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_cement_mortar_brick <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_timber              <lgl> FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, ...
    ## $ has_superstructure_bamboo              <lgl> FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, ...
    ## $ has_superstructure_rc_non_engineered   <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_rc_engineered       <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_other               <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ legal_ownership_status                 <fct> v, v, v, v, v, v, v, v, v, v, v, a, v, v, v, v, ...
    ## $ count_families                         <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
    ## $ has_secondary_use                      <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, ...
    ## $ has_secondary_use_agriculture          <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, ...
    ## $ has_secondary_use_hotel                <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_rental               <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_institution          <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_school               <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_industry             <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_health_post          <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_gov_office           <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_use_police           <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_other                <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ damage_grade                           <dbl> 3, 2, 3, 2, 3, 2, 3, 1, 2, 1, 3, 2, 2, 3, 3, 2, ...

    ## ---
    ## new_data

    ## Observations: 86,868
    ## Variables: 40
    ## $ building_id                            <chr> "300051", "99355", "890251", "745817", "421793",...
    ## $ geo_level_1_id                         <int> 17, 6, 22, 26, 17, 22, 26, 8, 16, 26, 20, 21, 8,...
    ## $ geo_level_2_id                         <int> 596, 141, 19, 39, 289, 170, 432, 1373, 244, 761,...
    ## $ geo_level_3_id                         <int> 11307, 11987, 10044, 633, 7970, 4029, 6794, 958,...
    ## $ count_floors_pre_eq                    <int> 3, 2, 2, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 3, 2, 1, ...
    ## $ age                                    <int> 20, 25, 5, 0, 15, 55, 0, 35, 30, 5, 5, 30, 40, 7...
    ## $ area_percentage                        <int> 7, 13, 4, 19, 8, 4, 6, 2, 6, 6, 3, 7, 6, 9, 22, ...
    ## $ height_percentage                      <int> 6, 5, 5, 3, 7, 3, 7, 8, 5, 7, 5, 5, 6, 8, 6, 4, ...
    ## $ land_surface_condition                 <fct> t, t, t, t, t, t, n, t, t, n, t, t, t, n, t, t, ...
    ## $ foundation_type                        <fct> r, r, r, r, r, r, r, r, r, r, w, r, r, r, r, r, ...
    ## $ roof_type                              <fct> n, n, n, x, q, q, n, n, n, n, q, n, n, n, x, n, ...
    ## $ ground_floor_type                      <fct> f, f, f, v, f, f, v, f, f, f, f, v, f, f, v, f, ...
    ## $ other_floor_type                       <fct> q, q, q, j, q, j, x, q, x, x, q, x, q, q, s, j, ...
    ## $ position                               <fct> s, s, s, t, t, s, s, s, s, s, s, s, j, s, s, s, ...
    ## $ plan_configuration                     <fct> d, d, d, d, d, d, d, d, d, d, u, d, d, d, d, d, ...
    ## $ has_superstructure_adobe_mud           <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_mud_mortar_stone    <lgl> TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, FALSE, TRUE...
    ## $ has_superstructure_stone_flag          <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_cement_mortar_stone <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_mud_mortar_brick    <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_cement_mortar_brick <lgl> FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, F...
    ## $ has_superstructure_timber              <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_bamboo              <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_rc_non_engineered   <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_rc_engineered       <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_superstructure_other               <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, ...
    ## $ legal_ownership_status                 <fct> v, v, v, v, v, v, v, v, v, v, a, v, v, v, v, v, ...
    ## $ count_families                         <int> 1, 1, 1, 2, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 2, 1, ...
    ## $ has_secondary_use                      <lgl> FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, F...
    ## $ has_secondary_use_agriculture          <lgl> FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, ...
    ## $ has_secondary_use_hotel                <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_rental               <lgl> FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, ...
    ## $ has_secondary_use_institution          <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_school               <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_industry             <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_health_post          <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_gov_office           <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_use_police           <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ has_secondary_use_other                <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,...
    ## $ damage_grade                           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ...

    ## ---
    ## submission_format

    ## Observations: 86,868
    ## Variables: 2
    ## $ building_id  <dbl> 300051, 99355, 890251, 745817, 421793, 871976, 691228, 896100, 343471, 766...
    ## $ damage_grade <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...

<!--
## Function Dependencies


-->
